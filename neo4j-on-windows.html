
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://rasor.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://rasor.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://rasor.github.io/theme/font-awesome/css/font-awesome.min.css">

    <link href="https://rasor.github.io/static/custom.css" rel="stylesheet">

    <link href="https://rasor.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Rasor's Tech Blog Atom">


    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="img/favicon.ico" type="image/x-icon">



<meta name="author" content="rasor" />
<meta name="description" content="Time for me to play with Neo4j. I have a project, where a graph DB makes most sense. In this blog I&#39;ll install Neo4j on Windows. First I&#39;ll install a docker version. It might come handy in deployment case. Next I&#39;ll install a Desktop version to get a GUI both …" />
<meta name="keywords" content="#graphdb, #cypher, #neo4j, #docker">

<meta property="og:site_name" content="Rasor's Tech Blog"/>
<meta property="og:title" content="Neo4j on Windows"/>
<meta property="og:description" content="Time for me to play with Neo4j. I have a project, where a graph DB makes most sense. In this blog I&#39;ll install Neo4j on Windows. First I&#39;ll install a docker version. It might come handy in deployment case. Next I&#39;ll install a Desktop version to get a GUI both …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://rasor.github.io/neo4j-on-windows.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-05-08 00:00:00+02:00"/>
<meta property="article:modified_time" content="2019-05-08 00:00:00+02:00"/>
<meta property="article:author" content="https://rasor.github.io/author/rasor.html">
<meta property="article:section" content="DevOp"/>
<meta property="article:tag" content="#graphdb"/>
<meta property="article:tag" content="#cypher"/>
<meta property="article:tag" content="#neo4j"/>
<meta property="article:tag" content="#docker"/>
<meta property="og:image" content="//s.gravatar.com/avatar/5b6cf6c4e0fa216452dccc8158bf673f?s=120">

  <title>Rasor's Tech Blog &ndash; Neo4j on Windows</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://rasor.github.io">
        <img src="//s.gravatar.com/avatar/5b6cf6c4e0fa216452dccc8158bf673f?s=120" alt="Rasor's Tech Blog" title="Rasor's Tech Blog">
      </a>
      <h1><a href="https://rasor.github.io">Rasor's Tech Blog</a></h1>

<p>... still playing with this Lego</p>
      <nav>
        <ul class="list">

          <li><a href="https://stackoverflow.com/users/750989/rasor" target="_blank">StackOverflow</a></li>
          <li><a href="https://www.npmjs.com/~rasor" target="_blank">npm</a></li>
          <li><a href="https://dock.io?r=sorenraarup:aaaaCSAu" target="_blank">dock.io</a></li>
          <li><a href="https://keybase.io/rasor" target="_blank">Keybase</a></li>
          <li><a href="https://stackoverflow.com/cv/rasor" target="_blank">-- CV --</a></li>
          <li><a href="https://angel.co/rasor" target="_blank">AngelList</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-twitter" href="https://twitter.com/rasor" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/rasor" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-wordpress" href="https://rasor.wordpress.com" target="_blank"><i class="fa fa-wordpress"></i></a></li>
        <li><a class="sc-github" href="https://github.com/rasor" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-bitbucket" href="https://bitbucket.org/rasor" target="_blank"><i class="fa fa-bitbucket"></i></a></li>
        <li><a class="sc-rss" href="/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://rasor.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="/sitemap.xml">Sitemap</a>

      <a href="https://rasor.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="neo4j-on-windows">Neo4j on Windows</h1>
    <p>
          Posted on May 08, 2019 in <a href="https://rasor.github.io/category/devop.html">DevOp</a>

          </br>
            Updated: May 08, 2019
    </p>
  </header>


  <div>
    <p>Time for me to play with Neo4j. I have a project, where a graph DB makes most sense. In this blog I'll install Neo4j on Windows.<br>
First I'll install a docker version. It might come handy in deployment case.<br>
Next I'll install a Desktop version to get a GUI both for management, but mostly for a data editing interface.  </p>
<h2>Neo4j - editions</h2>
<p>So what is out there to install?</p>
<p>On the <a href="https://neo4j.com/download-center/">Neo4j Download</a> page you have options to download </p>
<ul>
<li>two server versions, <ul>
<li><strong>Enterprise</strong> or </li>
<li><strong>Community</strong>. You also have option of downloading </li>
</ul>
</li>
<li>a <strong>Desktop</strong> version with a <strong>GUI</strong> included.</li>
<li>A Cypher <strong>CLI</strong> is a separate install.</li>
</ul>
<p><a href="https://neo4j.com/developer/kb/using-neo4j-shell-neo4j-ce-3x/">Neo4j KB article</a> talks about <strong>CLIs</strong>. There you find a handy script for a Neo4j <strong>docker container</strong>. </p>
<p>From the the download page I'll grap</p>
<ul>
<li>Neo4j Desktop</li>
<li>SDK for JavaScript and possibly some plugins</li>
</ul>
<p>From the KB article I'll grap the Neo4j Docker script and modify it a bit.</p>
<h2>Install Docker Container edition</h2>
<p>From <a href="https://neo4j.com/developer/kb/using-neo4j-shell-neo4j-ce-3x/">Neo4j KB article</a> you'll find this script:</p>
<div class="highlight"><pre><span></span><span class="c1"># Script from https://neo4j.com/developer/kb/using-neo4j-shell-neo4j-ce-3x/</span>
docker pull neo4j
<span class="nv">CONTAINER</span><span class="o">=</span><span class="k">$(</span>docker run -d --name neo4j -p <span class="m">7474</span>:7474 -v /path/to/data:/data -v /path/to/csv-files:/var/lib/neo4j/import neo4j<span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&quot;Running Neo4j as </span><span class="nv">$CONTAINER</span><span class="s2">, waiting for startup&quot;</span>
sleep <span class="m">10</span>
<span class="c1"># to import a file from `/path/to/csv-files/import.cypher`</span>
docker <span class="nb">exec</span> <span class="nv">$CONTAINER</span> /var/lib/neo4j/bin/neo4j-shell -f /var/lib/neo4j/import/import.cypher
<span class="c1"># or for interactive mode</span>
docker <span class="nb">exec</span> -ti <span class="nv">$CONTAINER</span> /var/lib/neo4j/bin/neo4j-shell
</pre></div>


<p>Here is what I modified it to on Windows:  </p>
<p>From CMD: (Run as admin)</p>
<div class="highlight"><pre><span></span><span class="c1"># Set envir for Neo4j database files - notice folder format is not Linux, though it will be used from GIT BASH</span>
setx NEO_DATA <span class="s2">&quot;C:\Users\user\ItData\neodata\neo4jDatabases&quot;</span> /M
<span class="c1"># SUCCESS: Specified value was saved.</span>
</pre></div>


<p>From Git Bash:</p>
<div class="highlight"><pre><span></span><span class="c1"># Optionally do some cleanup:</span>
docker system prune
<span class="c1"># WARNING! This will remove:</span>
<span class="c1">#         - all stopped containers</span>
<span class="c1">#         - all networks not used by at least one container</span>
<span class="c1">#         - all dangling images</span>
<span class="c1">#         - all dangling build cache</span>
<span class="c1"># Are you sure you want to continue? [y/N] y</span>

<span class="c1"># Download image from docker hub</span>
<span class="c1"># 3.5.5 is currently latest neo4j image</span>
docker pull neo4j:3.5.5
<span class="c1"># ...</span>
<span class="c1"># Status: Downloaded newer image for neo4j:3.5.5</span>

<span class="c1"># Verify envir</span>
printenv <span class="p">|</span> grep NEO
<span class="c1"># NEO_DATA_BASH=C:\Users\user\ItData\neodata</span>

<span class="c1"># Create folder for the container and for CYPHER CSV imports</span>
<span class="nb">cd</span> <span class="nv">$NEO_DATA</span>
mkdir docker-container1 <span class="o">&amp;&amp;</span> <span class="nb">cd</span> docker-container1 <span class="o">&amp;&amp;</span> mkdir import <span class="o">&amp;&amp;</span> mkdir data

<span class="c1"># Start Docker</span>

<span class="c1"># Map a DB data folder and an CSV import folder on your PC for a Neo4j container and start it</span>
<span class="c1"># https://neo4j.com/docs/operations-manual/current/docker/introduction/#docker-volumes</span>
<span class="nv">CONTAINER</span><span class="o">=</span><span class="k">$(</span>docker run -d --name neo4j -p <span class="m">7474</span>:7474 -v <span class="nv">$NEO_DATA</span>/docker-container1/data:/data -v <span class="nv">$NEO_DATA</span>/docker-container1/import:/var/lib/neo4j/import neo4j<span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&quot;Running Neo4j as </span><span class="nv">$CONTAINER</span><span class="s2">, waiting for startup&quot;</span>
sleep <span class="m">10</span>

<span class="c1"># iIs it running?</span>
docker ps
<span class="c1"># CONTAINER ID        IMAGE                         COMMAND                  CREATED              STATUS              PORTS                                        NAMES</span>
<span class="c1"># 95f89a2b0956        neo4j                         &quot;/sbin/tini -g -- /d…&quot;   About a minute ago   Up About a minute   7473/tcp, 7687/tcp, 0.0.0.0:7474-&gt;7474/tcp   neo4j</span>

<span class="c1"># Whats in its log? </span>
docker logs neo4j
<span class="c1"># Active database: graph.db</span>
<span class="c1"># Directories in use:</span>
<span class="c1">#   home:         /var/lib/neo4j</span>
<span class="c1">#   config:       /var/lib/neo4j/conf</span>
<span class="c1">#   logs:         /logs</span>
<span class="c1">#   plugins:      /var/lib/neo4j/plugins</span>
<span class="c1">#   import:       /var/lib/neo4j/import</span>
<span class="c1">#   data:         /var/lib/neo4j/data</span>
<span class="c1">#   certificates: /var/lib/neo4j/certificates</span>
<span class="c1">#   run:          /var/lib/neo4j/run</span>
<span class="c1"># Starting Neo4j.</span>

<span class="c1"># So when container was started it created a DB with</span>

<span class="c1"># to import a file from `$NEO_DATA_BASH/import/import.cypher`</span>
<span class="c1"># docker exec $CONTAINER /var/lib/neo4j/bin/neo4j-shell -f /var/lib/neo4j/import/import.cypher</span>

<span class="c1"># or for interactive mode</span>
docker <span class="nb">exec</span> -ti <span class="nv">$CONTAINER</span> /var/lib/neo4j/bin/neo4j-shell
<span class="c1"># the input device is not a TTY.  If you are using mintty, try prefixing the command with &#39;winpty&#39;</span>

<span class="c1"># Annoying could not connect - the one fix I know is to repeat the command from the PS1 Docker CLI, which you can start from Kitematic or directly from Kitematic</span>
</pre></div>


<p>From Kitematic:</p>
<ul>
<li>Select the <strong>neo4j</strong> container</li>
<li>Press <strong>EXEC</strong> icon<ul>
<li>This will open a PS1 prompt</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="c"># where are we?</span>
<span class="n">pwd</span>
<span class="c"># /var/lib/neo4j</span>

<span class="c"># What is the version?</span>
<span class="p">./</span><span class="n">bin</span><span class="p">/</span><span class="n">neo4j</span> <span class="p">-</span><span class="n">-version</span>
<span class="c"># neo4j 3.5.5</span>

<span class="c"># now run the shell from here - neo4j-shell is now cypher-shell</span>
<span class="p">./</span><span class="n">bin</span><span class="p">/</span><span class="n">cypher-shell</span>
<span class="c"># username: neo4j</span>
<span class="c"># password: neo4j</span>
<span class="c"># Connected to Neo4j 3.5.5 at bolt://localhost:7687 as user neo4j.</span>
<span class="c"># Type :help for a list of available commands or :exit to exit the shell.</span>
<span class="c"># Note that Cypher queries must end with a semicolon.</span>
<span class="c"># neo4j&gt;</span>
<span class="err">:</span><span class="n">help</span>
<span class="c"># Available commands:</span>
<span class="c">#   :begin    Open a transaction</span>
<span class="c">#   :commit   Commit the currently open transaction</span>
<span class="c">#   :exit     Exit the logger</span>
<span class="c">#   :help     Show this help message</span>
<span class="c">#   :history  Print a list of the last commands executed</span>
<span class="c">#   :param    Set the value of a query parameter</span>
<span class="c">#   :params   Prints all currently set query parameters and their values</span>
<span class="c">#   :rollback Rollback the currently open transaction</span>
<span class="c"># For help on a specific command type:</span>
<span class="c">#     :help command</span>
<span class="c"># For help on cypher please visit:</span>
<span class="c">#     https://neo4j.com/docs/developer-manual/current/cypher/</span>
<span class="err">:</span><span class="n">exit</span>
</pre></div>


<p>When you are done using the shell you can just close it with Alt+F5.<br>
When you are done with using the DB, you can stop it from GIT BASH</p>
<div class="highlight"><pre><span></span>docker stop neo4j
</pre></div>


<ul>
<li>More info on <a href="https://hub.docker.com/_/neo4j?tab=description">Docker Hub</a></li>
<li>Even more on <a href="https://neo4j.com/docs/operations-manual/current/docker/">Docker - The Neo4j Operations Manual v3.5</a></li>
<li>Tutorial: <a href="https://neo4j.com/developer/guide-importing-data-and-etl/">Neo4j Data Import: Moving Data from RDBMS to Graph</a></li>
</ul>
<h2>Windows Desktop edition</h2>
<p>It is still nice to have the Desktop edition. You get the browser and you can connect to the docker DB.</p>
<h3>Install Neo4j Desktop</h3>
<p>You can install Neo4j for personal use into<br>
<code>C:\Users\user\AppData\Local\Programs\Neo4j Desktop</code><br>
or for all users into<br>
<code>C:\Program Files\Neo4j Desktop</code></p>
<p>The default place it wants to place your data is 
<code>C:\Users\user\.Neo4jDesktop</code><br>
I want it shared with my docker install into<br>
<code>C:\Users\user\ItData\neodata</code><br>
Warnings: </p>
<ul>
<li>When you uninstall neo4j it will delete the whole folder, but you can choose option to backup, so you still have the data for e.g. your docker container</li>
<li>In some countries you will get message <code>You are not online so you can not 'Register via Social Login'</code>, when starting Neo4j. <ul>
<li>Solution A: Use VPN to get access from another country.</li>
<li>Solution B: Work offline (if that is enough). For development it probably is. You can also get an activation key via email. You'll get this supportive message: <code>Your friendly neighborhood Neo4j representative can get an activation key for you. If you're not sure who to call send an inquiry to info@neo4j.com</code></li>
</ul>
</li>
</ul>
<h3>Create a local graph DB</h3>
<p>You can connect towards an exiting local or remote graph DB - or you can create a new local one.<br>
Since the docker uses same port you should stop it first</p>
<div class="highlight"><pre><span></span>docker stop neo4j
</pre></div>


<p>To create a new local graph DB </p>
<ul>
<li>Click on <code>Add Graph</code><ul>
<li>You can now create a local graph or connect to a remote one. You could have started the container and have connected towards that one</li>
<li>Instead - Create the local one (I am just exploring anyway) </li>
</ul>
</li>
<li>
<p>Give it a name, a password and click <code>Create</code></p>
<ul>
<li>I called this one <code>NeoGraphTest1</code>
<img alt="Add local DB" src="img/2019/2019-05-07-Neo4j01.PNG">  </li>
</ul>
</li>
<li>
<p>This will create the DB in a folder below what you chose during installation</p>
<ul>
<li>In my case the DB is in <code>\neodata\neo4jDatabases\database-876bd4d5-067b-4558-8793-8cebca8e06e1\installation-3.5.2\data\databases\graph.db</code></li>
<li>So that is why I put the container data folder into <code>\neodata\neo4jDatabases\container1\data</code>. This keeps it separated in the same level except that I have left out the installation version. If I needed that I would instead have called the folder <code>\container1-3.5.5\</code>. </li>
<li>The level <code>\database-876bd4d5-067b-4558-8793-8cebca8e06e1\installation-3.5.2</code> gives you the content of <code>NeoGraphTest1</code><ul>
<li>It has all the files as the container has including <code>\bin\</code> folder - but these are the Windows files opposed to the Linux files in the container
<img alt="DB folder" src="img/2019/2019-05-07-Neo4j02.PNG">  </li>
</ul>
</li>
</ul>
</li>
<li>
<p>The new DB is stopped. You can start it from the <strong>project page</strong> or you can press <code>Manage</code> to enter the <strong>DB page</strong> for <code>NeoGraphTest1</code></p>
<ul>
<li>On DB page you have a dashboard to a lot - most importantly to <strong>start</strong> the DB and to connect to it with the <strong>Cypher Browser</strong></li>
<li>Press <code>Start</code>
<img alt="Stopped DB" src="img/2019/2019-05-07-Neo4j03.PNG">  </li>
</ul>
</li>
<li>
<p>With the DB started you get to know the ports it 
<img alt="Running DB" src="img/2019/2019-05-07-Neo4j04.PNG"></p>
</li>
</ul>
<h3>Connect to your docker container graph DB</h3>
<p>The docker neo4j DB is easy to intall into cloud, so lets get aquainted with connecting to that as well.
Since the docker uses same port as <code>NeoGraphTest1</code> you should stop <code>NeoGraphTest1</code> first and start docker.  </p>
<div class="highlight"><pre><span></span>docker start neo4j
</pre></div>


<h4>Just browse docker</h4>
<p>To browse the docker Graph with Cypher</p>
<ul>
<li>
<p>From Neo4j Desktop Click on <code>Neo4j Browser</code>
<img alt="Browse remote DB" src="img/2019/2019-05-07-Neo4j06.PNG"><br>
A new window opens and complains that it can't connect to <code>bolt://localhost:7687</code>.  </p>
</li>
<li>
<p>You need to help it with username/password.</p>
</li>
<li>In the cypher prompt enter command <code>:server connect neo4j neo4j</code>
<img alt="Connect to remote DB" src="img/2019/2019-05-07-Neo4j07.PNG">  </li>
</ul>
<p>The response is displayed in a box below. If you are connected, then just press <code>X</code> to cleanup.
<img alt="Connect response" src="img/2019/2019-05-07-Neo4j08.PNG">  </p>
<ul>
<li>When you are done you can <code>:server disconnect</code></li>
</ul>
<h4>Save the docker browser</h4>
<p>You could also save the link to the docker Graph just as <code>NeoGraphTest1</code>  </p>
<ul>
<li>From Neo4j Desktop Click on <code>Add Graph</code></li>
<li>Click on <code>Connect to Remote</code></li>
<li>Name: <code>NeoContainer1</code></li>
<li>
<p>Url: <code>bolt://localhost:7687</code>
<img alt="Add remote DB" src="img/2019/2019-05-07-Neo4j05.PNG">  </p>
</li>
<li>
<p>Press <code>Username/Password</code></p>
</li>
<li>User: <code>neo4j</code></li>
<li>Password: <code>neo4j</code></li>
<li>Press <code>Connect</code></li>
<li>
<p>Press <code>Start</code>
<img alt="Connected remote DB" src="img/2019/2019-05-07-Neo4j09.PNG">  </p>
</li>
<li>
<p>Press <code>Open Browser</code></p>
</li>
</ul>
<p>Notes:   </p>
<ul>
<li>After restarting the container at one point I hade to add the port 7687 in Kitematic to be able to connect</li>
<li>When you connect to the container remotely you also have to change the default password from <code>neo4j</code> after opening it in the browser</li>
</ul>
<h3>Installation Guides</h3>
<ul>
<li><a href="https://neo4j.com/docs/operations-manual/current/installation/windows/">2.5. Windows installation</a></li>
<li><a href="https://neo4j.com/download-thanks-desktop/?edition=desktop&amp;flavour=windows&amp;release=1.1.21&amp;offline=true">Neo4j Desktop</a></li>
</ul>
<h2>What's next?</h2>
<ul>
<li>Play with Cypher to add and read some data</li>
<li>Create some code to interact with the data</li>
<li>Change ports on local DB, so it doesn't collide with the docker DB.</li>
</ul>
<h2>Learn and Communities</h2>
<ul>
<li><a href="https://community.neo4j.com/">Neo4j Community</a></li>
<li>Cypher:<ul>
<li><a href="https://neo4j.com/developer/cypher-query-language/">Neo4j's Graph Query Language: An Introduction to Cypher</a></li>
<li><a href="https://www.quackit.com/neo4j/tutorial/neo4j_create_a_node_using_cypher.cfm">Neo4j - Create a Node using Cypher</a></li>
</ul>
</li>
<li>eBooks:<ul>
<li><a href="https://neo4j.com/books/">Neo4j Books: Free Graph Database Ebooks</a><ul>
<li><a href="https://neo4j.com/whitepapers/graph-databases-beginners-ebook/?ref=home">Graph Databases for Beginners - Neo4j Graph Database Platform</a></li>
<li><a href="https://neo4j.com/graph-algorithms-book/">O'Reilly Graph Algorithms Book - Neo4j Graph Database Platform</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The End</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://rasor.github.io/tag/graphdb.html">#graphdb</a>
      <a href="https://rasor.github.io/tag/cypher.html">#cypher</a>
      <a href="https://rasor.github.io/tag/neo4j.html">#neo4j</a>
      <a href="https://rasor.github.io/tag/docker.html">#docker</a>
    </p>
  </div>



    <div class="addthis_relatedposts_inline">


</article>

    <footer>
<p>
  &copy; rasor 2017 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Rasor's Tech Blog ",
  "url" : "https://rasor.github.io",
  "image": "//s.gravatar.com/avatar/5b6cf6c4e0fa216452dccc8158bf673f?s=120",
  "description": ""
}
</script>

</body>
</html>